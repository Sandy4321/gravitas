---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```
# gravitas

<!-- badges: start -->

[![Travis-CI Build Status](https://travis-ci.org/Sayani07/gravitas.svg?branch=master)](https://travis-ci.org/Sayani07/gravitas)
<!-- badges: end -->

The package **gravitas** provides a tool to examine the probability distribution of univariate time series across bivariate temporal granularities using range of graphics in `ggplot2` through the following:  

 - create multiple-order-up circular or aperiodic temporal granularities.  
 
 - categorize pairs of granularities as either  *harmony* or *clash*, where harmonies are pairs of granularities that aid exploratory data analysis, and clashes are pairs that are incompatible with each other for exploratory analysis.  
 
 - recommending appropriate probability distribution plots of the time series variable across the bivariate granularities based on the levels of the bivariate granularties and their compatibility relationship.  

## Installation
  
<!-- You can install the released version of gravitas from [CRAN](https://CRAN.R-project.org) with: -->

<!-- ``` r -->
<!-- install.packages("gravitas") -->
<!-- ``` -->

You can install the development version from [GitHub](https://github.com/) with:

``` r
# install.packages("devtools")
devtools::install_github("Sayani07/gravitas")
```
## Get started

The `vic_elec` data from tsibbledata package is employed to have a run through of this package. It is a half-hourly tsibble consisting of half hour demand for the state of Victoria. Suppose it is of interest to to examine how the univariate series `Demand` varies with different deconstructions of time.


```{r example1}
library(gravitas)
library(dplyr)
tsibbledata::vic_elec %>% search_gran()
```

The default for search gran in this case,  provides temporal granularities ranging from half-hour to year. If these options are considered too many, the default options can be modified to limit the possibilities. For example, the most coarce temporal unit can be set to be "month".

```{r example2}
library(gravitas)
library(dplyr)
tsibbledata::vic_elec %>% search_gran(ugran = "month")
```

This looks better. However, some intermediate temporal units might not be pertinent to the analysis and we might want to  remove them from the list of granularities that we want to examine.

```{r example3}
library(gravitas)
library(dplyr)
tsibbledata::vic_elec %>% search_gran(ugran = "month", filter_out = c("fortnight"))
```

Now that we have the list of granularities that we want to look at, let us see which pairs form harmony/clash.

```{r example4}
library(gravitas)
library(dplyr)
tsibbledata::vic_elec %>% is.harmony(gran1 = "hhour_week", gran2 ="day_week")

tsibbledata::vic_elec %>% is.harmony(gran1 = "hour_day", gran2 ="day_week")

tsibbledata::vic_elec %>% is.harmony(gran1 = "day_month", gran2 ="hhour_week")

```

Or, we can find the set of harmonies all at once with the help of function `harmony`.

```{r example5}
tsibbledata::vic_elec %>% harmony(ugran = "month", filter_out = c("fortnight", "hhour")) 
```

Now, we want to view distribution of `Demand' across these bivariate granularities through boxplots.

```{r example6}
tsibbledata::vic_elec %>% granplot("hour_day", "day_week", "Demand", plot_type = "boxplot")
```
Now, we want to view distribution of `Demand' across the next set of harmonies - hour_day and day_month and let the package decide 
the plot type that is best suitable for the number of levels in hour_day and day_month.

```{r example7}
tsibbledata::vic_elec %>% granplot("hour_day", "day_week", "Demand") + ggplot2::scale_x_discrete(breaks = seq(1,24,2))
```

If we want to switch the facet and x-axis variable, we simply reverse the order of time granularities. Here, granplot would output a ggplot2 object. So we are free to add any element to the default plot.

```{r example8}
tsibbledata::vic_elec %>% granplot("day_week", "hour_day", "Demand", plot_type = "violin") + ggplot2::scale_x_discrete(breaks = seq(1,24,2))
```

