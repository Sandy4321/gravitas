<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Exploring probability distributions for bivariate temporal granularities with gravitas • gravitas</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Exploring probability distributions for bivariate temporal granularities with gravitas">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">gravitas</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/gravitas_vignette.html">Exploring probability distributions for bivariate temporal granularities with gravitas</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/Sayani07/gravitas">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Exploring probability distributions for bivariate temporal granularities with gravitas</h1>
                        <h4 class="author">
<i>Sayani Gupta</i>
<hr>
</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/Sayani07/gravitas/blob/master/vignettes/gravitas_vignette.Rmd"><code>vignettes/gravitas_vignette.Rmd</code></a></small>
      <div class="hidden name"><code>gravitas_vignette.Rmd</code></div>

    </div>

    
    
<!-- #Example vignette: 
https://github.com/njtierney/naniar/blob/master/vignettes/getting-started-w-naniar.Rmd -->
<p>The package <strong>gravitas</strong> provides a tool to examine the probability distribution of univariate time series across bivariate temporal granularities using range of graphics in <code>ggplot2</code> through the following:</p>
<ul>
<li><p>create multiple-order-up circular or aperiodic temporal granularities.</p></li>
<li><p>categorize pairs of granularities as either <em>harmony</em> or <em>clash</em>, where harmonies are pairs of granularities that aid exploratory data analysis, and clashes are pairs that are incompatible with each other for exploratory analysis.</p></li>
<li><p>recommending appropriate probability distribution plots of the time series variable across the bivariate granularities based on the levels of the bivariate granularties and their compatibility relationship.</p></li>
</ul>
<div id="get-started" class="section level2">
<h2 class="hasAnchor">
<a href="#get-started" class="anchor"></a>Get started</h2>
<p>One of the <a href="https://data.gov.au/dataset/ds-dga-4e21dea3-9b87-4610-94c7-15a8a77907ef/details?q=smart-meter">customer trials</a> conducted as part of the Smart Grid Smart City (SGSC) project (2010-2014) in Newcastle, New South Wales and some parts of Sydney providing customer wise data is employed to have a run through of this package. The data consists of half-hourly demand <code>general_supply_kwh</code> for more than 40k households across these places. Suppose we want to explore the probability distribution of the energy consumption for these households across different time granularities and identify their behavioral patterns. Data for the year 2013 for one household is used for illustration purposes.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1">smart_meter_nsw &lt;-<span class="st"> </span>sm_cust1 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as_tsibble</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ungroup</span>()</a></code></pre></div>
<div id="get-set-of-possible-temporal-granularities-with-search_gran" class="section level3">
<h3 class="hasAnchor">
<a href="#get-set-of-possible-temporal-granularities-with-search_gran" class="anchor"></a>Get set of possible temporal granularities with <code>search_gran()</code>
</h3>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">smart_meter_nsw <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/search_gran.html">search_gran</a></span>()</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="co">#&gt;  [1] "hhour_hour"         "hhour_day"          "hhour_week"        </span></a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="co">#&gt;  [4] "hhour_fortnight"    "hhour_month"        "hhour_quarter"     </span></a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="co">#&gt;  [7] "hhour_semester"     "hhour_year"         "hour_day"          </span></a>
<a class="sourceLine" id="cb2-5" data-line-number="5"><span class="co">#&gt; [10] "hour_week"          "hour_fortnight"     "hour_month"        </span></a>
<a class="sourceLine" id="cb2-6" data-line-number="6"><span class="co">#&gt; [13] "hour_quarter"       "hour_semester"      "hour_year"         </span></a>
<a class="sourceLine" id="cb2-7" data-line-number="7"><span class="co">#&gt; [16] "day_week"           "day_fortnight"      "day_month"         </span></a>
<a class="sourceLine" id="cb2-8" data-line-number="8"><span class="co">#&gt; [19] "day_quarter"        "day_semester"       "day_year"          </span></a>
<a class="sourceLine" id="cb2-9" data-line-number="9"><span class="co">#&gt; [22] "week_fortnight"     "week_month"         "week_quarter"      </span></a>
<a class="sourceLine" id="cb2-10" data-line-number="10"><span class="co">#&gt; [25] "week_semester"      "week_year"          "fortnight_month"   </span></a>
<a class="sourceLine" id="cb2-11" data-line-number="11"><span class="co">#&gt; [28] "fortnight_quarter"  "fortnight_semester" "fortnight_year"    </span></a>
<a class="sourceLine" id="cb2-12" data-line-number="12"><span class="co">#&gt; [31] "month_quarter"      "month_semester"     "month_year"        </span></a>
<a class="sourceLine" id="cb2-13" data-line-number="13"><span class="co">#&gt; [34] "quarter_semester"   "quarter_year"       "semester_year"</span></a></code></pre></div>
</div>
<div id="refine-your-search-of-possible-temporal-granularities-by-altering-arguments-in-search_gran" class="section level3">
<h3 class="hasAnchor">
<a href="#refine-your-search-of-possible-temporal-granularities-by-altering-arguments-in-search_gran" class="anchor"></a>Refine your search of possible temporal granularities by altering arguments in <code>search_gran()</code>
</h3>
<p>The default for search gran in this case, provides temporal granularities ranging from half-hour to year. If these options are considered too many, the default options can be modified to limit the possibilities. For example, the most coarce temporal unit can be set to be “month”.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"></a>
<a class="sourceLine" id="cb3-2" data-line-number="2">smart_meter_nsw <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/search_gran.html">search_gran</a></span>(<span class="dt">highest_unit  =</span> <span class="st">"month"</span>)</a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="co">#&gt;  [1] "hhour_hour"      "hhour_day"       "hhour_week"     </span></a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="co">#&gt;  [4] "hhour_fortnight" "hhour_month"     "hour_day"       </span></a>
<a class="sourceLine" id="cb3-5" data-line-number="5"><span class="co">#&gt;  [7] "hour_week"       "hour_fortnight"  "hour_month"     </span></a>
<a class="sourceLine" id="cb3-6" data-line-number="6"><span class="co">#&gt; [10] "day_week"        "day_fortnight"   "day_month"      </span></a>
<a class="sourceLine" id="cb3-7" data-line-number="7"><span class="co">#&gt; [13] "week_fortnight"  "week_month"      "fortnight_month"</span></a></code></pre></div>
<p>This looks better. However, some intermediate temporal units might not be pertinent to the analysis and we might want to remove them from the list of granularities that we want to examine.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"></a>
<a class="sourceLine" id="cb4-2" data-line-number="2">smart_meter_nsw <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/search_gran.html">search_gran</a></span>(<span class="dt">highest_unit =</span> <span class="st">"month"</span>, <span class="dt">filter_out =</span> <span class="st">"fortnight"</span>)</a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="co">#&gt;  [1] "hhour_hour"  "hhour_day"   "hhour_week"  "hhour_month" "hour_day"   </span></a>
<a class="sourceLine" id="cb4-4" data-line-number="4"><span class="co">#&gt;  [6] "hour_week"   "hour_month"  "day_week"    "day_month"   "week_month"</span></a></code></pre></div>
</div>
<div id="check-if-two-temporal-granularities-are-harmonies-with-is_harmony" class="section level3">
<h3 class="hasAnchor">
<a href="#check-if-two-temporal-granularities-are-harmonies-with-is_harmony" class="anchor"></a>Check if two temporal granularities are harmonies with <code>is_harmony()</code>
</h3>
<p>Now that we have the list of granularities that we want to look at, let us see which pairs form harmony/clash.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"></a>
<a class="sourceLine" id="cb5-2" data-line-number="2">smart_meter_nsw <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/is_harmony.html">is_harmony</a></span>(<span class="dt">gran1 =</span> <span class="st">"hour_day"</span>, <span class="dt">gran2 =</span> <span class="st">"day_week"</span>)</a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="co">#&gt; [1] "TRUE"</span></a>
<a class="sourceLine" id="cb5-4" data-line-number="4"></a>
<a class="sourceLine" id="cb5-5" data-line-number="5">smart_meter_nsw <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/is_harmony.html">is_harmony</a></span>(<span class="dt">gran1 =</span> <span class="st">"hour_day"</span>, <span class="dt">gran2 =</span> <span class="st">"day_week"</span>, <span class="dt">facet_h =</span> <span class="dv">14</span>)</a>
<a class="sourceLine" id="cb5-6" data-line-number="6"><span class="co">#&gt; [1] "FALSE"</span></a>
<a class="sourceLine" id="cb5-7" data-line-number="7"></a>
<a class="sourceLine" id="cb5-8" data-line-number="8">smart_meter_nsw <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/is_harmony.html">is_harmony</a></span>(<span class="dt">gran1 =</span> <span class="st">"day_month"</span>, <span class="dt">gran2 =</span> <span class="st">"hhour_week"</span>)</a>
<a class="sourceLine" id="cb5-9" data-line-number="9"><span class="co">#&gt; [1] "FALSE"</span></a></code></pre></div>
</div>
<div id="get-all-possible-harmonies-with-harmony" class="section level3">
<h3 class="hasAnchor">
<a href="#get-all-possible-harmonies-with-harmony" class="anchor"></a>Get all possible harmonies with <code>harmony()</code>
</h3>
<p>Or, we can find the set of harmonies all at once with the help of function <code>harmony</code>.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">smart_meter_nsw  <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/harmony.html">harmony</a></span>(<span class="dt">ugran =</span> <span class="st">"month"</span>,</a>
<a class="sourceLine" id="cb6-2" data-line-number="2">                             <span class="dt">filter_out =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"fortnight"</span>, <span class="st">"hhour"</span>),</a>
<a class="sourceLine" id="cb6-3" data-line-number="3">                             <span class="dt">filter_in =</span> <span class="st">"wknd_wday"</span>)</a>
<a class="sourceLine" id="cb6-4" data-line-number="4"><span class="co">#&gt; # A tibble: 78 x 4</span></a>
<a class="sourceLine" id="cb6-5" data-line-number="5"><span class="co">#&gt;    facet_variable  x_variable facet_levels x_levels</span></a>
<a class="sourceLine" id="cb6-6" data-line-number="6"><span class="co">#&gt;    &lt;chr&gt;           &lt;chr&gt;             &lt;int&gt;    &lt;int&gt;</span></a>
<a class="sourceLine" id="cb6-7" data-line-number="7"><span class="co">#&gt;  1 hour_day        hhour_hour           24        2</span></a>
<a class="sourceLine" id="cb6-8" data-line-number="8"><span class="co">#&gt;  2 day_week        hhour_hour            7        2</span></a>
<a class="sourceLine" id="cb6-9" data-line-number="9"><span class="co">#&gt;  3 day_fortnight   hhour_hour           14        2</span></a>
<a class="sourceLine" id="cb6-10" data-line-number="10"><span class="co">#&gt;  4 day_month       hhour_hour           31        2</span></a>
<a class="sourceLine" id="cb6-11" data-line-number="11"><span class="co">#&gt;  5 week_fortnight  hhour_hour            2        2</span></a>
<a class="sourceLine" id="cb6-12" data-line-number="12"><span class="co">#&gt;  6 week_month      hhour_hour            5        2</span></a>
<a class="sourceLine" id="cb6-13" data-line-number="13"><span class="co">#&gt;  7 fortnight_month hhour_hour            3        2</span></a>
<a class="sourceLine" id="cb6-14" data-line-number="14"><span class="co">#&gt;  8 wknd_wday       hhour_hour            2        2</span></a>
<a class="sourceLine" id="cb6-15" data-line-number="15"><span class="co">#&gt;  9 day_week        hhour_day             7       48</span></a>
<a class="sourceLine" id="cb6-16" data-line-number="16"><span class="co">#&gt; 10 day_fortnight   hhour_day            14       48</span></a>
<a class="sourceLine" id="cb6-17" data-line-number="17"><span class="co">#&gt; # … with 68 more rows</span></a></code></pre></div>
</div>
<div id="explore-probability-distribution-across-bivariate-temporal-granularities-with-prob_plot" class="section level3">
<h3 class="hasAnchor">
<a href="#explore-probability-distribution-across-bivariate-temporal-granularities-with-prob_plot" class="anchor"></a>Explore probability distribution across bivariate temporal granularities with <code>prob_plot()</code>
</h3>
<p>Now, we want to view distribution of the measured variable <code>general_supply_kwh</code> across these bivariate granularities through different distribution plots using <code>prob_plot</code>.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">smart_meter_nsw  <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="../reference/prob_plot.html">prob_plot</a></span>(<span class="st">"day_week"</span>,</a>
<a class="sourceLine" id="cb7-3" data-line-number="3">           <span class="st">"hour_day"</span>,</a>
<a class="sourceLine" id="cb7-4" data-line-number="4">           <span class="st">"general_supply_kwh"</span>,</a>
<a class="sourceLine" id="cb7-5" data-line-number="5">           <span class="dt">plot_type =</span> <span class="st">"violin"</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb7-6" data-line-number="6"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html">scale_x_discrete</a></span>(<span class="dt">breaks =</span> <span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dv">1</span>, <span class="dv">24</span>, <span class="dv">3</span>))</a>
<a class="sourceLine" id="cb7-7" data-line-number="7"><span class="co">#&gt; The first measured variable</span></a>
<a class="sourceLine" id="cb7-8" data-line-number="8"><span class="co">#&gt;             plotted since no response variable specified</span></a>
<a class="sourceLine" id="cb7-9" data-line-number="9"><span class="co">#&gt; Warning in gran_warn(.data, gran1, gran2, hierarchy_tbl = hierarchy_tbl, : Number of observations for few combinations of</span></a>
<a class="sourceLine" id="cb7-10" data-line-number="10"><span class="co">#&gt;      granularities vary within or across facets.</span></a>
<a class="sourceLine" id="cb7-11" data-line-number="11"><span class="co">#&gt;      Use gran_obs() to find combinations which have low</span></a>
<a class="sourceLine" id="cb7-12" data-line-number="12"><span class="co">#&gt;             observations or very different number of observations.</span></a></code></pre></div>
<p><img src="gravitas_vignette_files/figure-html/example8-1.png" width="768" style="display: block; margin: auto;"></p>
<p>Suppose, we want a quantile plot, instead of a violin plot for viewing the distribution of energy consumption across similar temporal granularities.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">smart_meter_nsw  <span class="op">%&gt;%</span><span class="st"> </span><span class="kw"><a href="../reference/prob_plot.html">prob_plot</a></span>(<span class="st">"day_week"</span>,</a>
<a class="sourceLine" id="cb8-2" data-line-number="2">                              <span class="st">"hour_day"</span>,</a>
<a class="sourceLine" id="cb8-3" data-line-number="3">                              <span class="st">"general_supply_kwh"</span>,</a>
<a class="sourceLine" id="cb8-4" data-line-number="4">                              <span class="dt">plot_type =</span> <span class="st">"quantile"</span>, <span class="dt">quantile_prob =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.1</span>, <span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>, <span class="fl">0.9</span>))</a>
<a class="sourceLine" id="cb8-5" data-line-number="5"><span class="co">#&gt; The first measured variable</span></a>
<a class="sourceLine" id="cb8-6" data-line-number="6"><span class="co">#&gt;             plotted since no response variable specified</span></a>
<a class="sourceLine" id="cb8-7" data-line-number="7"><span class="co">#&gt; Warning in gran_warn(.data, gran1, gran2, hierarchy_tbl = hierarchy_tbl, : Number of observations for few combinations of</span></a>
<a class="sourceLine" id="cb8-8" data-line-number="8"><span class="co">#&gt;      granularities vary within or across facets.</span></a>
<a class="sourceLine" id="cb8-9" data-line-number="9"><span class="co">#&gt;      Use gran_obs() to find combinations which have low</span></a>
<a class="sourceLine" id="cb8-10" data-line-number="10"><span class="co">#&gt;             observations or very different number of observations.</span></a></code></pre></div>
<p><img src="gravitas_vignette_files/figure-html/example6-1.png" width="768" style="display: block; margin: auto;"></p>
<p>This provides an useful warning suggesting quantiles should be computed with caution as number of observations might not be enough for reliable estimates.</p>
<p><br></p>
<p>Now, we want to view distribution of <code>general_supply_kwh</code> across the another set of harmonies - month_year and hour_day and let the package decide the plot type that is best suitable.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">smart_meter_nsw  <span class="op">%&gt;%</span><span class="st">   </span></a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="st">    </span><span class="kw"><a href="../reference/prob_plot.html">prob_plot</a></span>(<span class="st">"month_year"</span>, <span class="st">"hour_day"</span>, </a>
<a class="sourceLine" id="cb9-3" data-line-number="3">           <span class="dt">response =</span> <span class="st">"general_supply_kwh"</span>, </a>
<a class="sourceLine" id="cb9-4" data-line-number="4">           <span class="co">#plot_type = "quantile", </span></a>
<a class="sourceLine" id="cb9-5" data-line-number="5">           <span class="dt">quantile_prob =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.1</span>, <span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>, <span class="fl">0.9</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb9-6" data-line-number="6"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">"Quantile plot across hour-of-day by month-of-year for Household 1"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb9-7" data-line-number="7"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dv">0</span>, <span class="fl">1.5</span>, <span class="fl">0.25</span>)) </a>
<a class="sourceLine" id="cb9-8" data-line-number="8"><span class="co">#&gt; Warning in gran_warn(.data, gran1, gran2, hierarchy_tbl = hierarchy_tbl, : Number of observations for few combinations of</span></a>
<a class="sourceLine" id="cb9-9" data-line-number="9"><span class="co">#&gt;      granularities vary within or across facets.</span></a>
<a class="sourceLine" id="cb9-10" data-line-number="10"><span class="co">#&gt;      Use gran_obs() to find combinations which have low</span></a>
<a class="sourceLine" id="cb9-11" data-line-number="11"><span class="co">#&gt;             observations or very different number of observations.</span></a></code></pre></div>
<p><img src="gravitas_vignette_files/figure-html/example7-1.png" width="768" style="display: block; margin: auto;"></p>
<p>Moving on, if we want to switch the facet and x-axis variable, we simply reverse the order of time granularities. Here, prob_plot would output a ggplot2 object. So we are free to add any element to the default plot.</p>
<p><br></p>
<p>Suppose, both the granularities chosen have too many levels, which is not suitable for facetting or are clashes, then warnings will be provided.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1">smart_meter_nsw  <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="../reference/prob_plot.html">prob_plot</a></span>(<span class="dt">gran1 =</span> <span class="st">"day_quarter"</span>,</a>
<a class="sourceLine" id="cb10-3" data-line-number="3">           <span class="dt">gran2 =</span> <span class="st">"day_week"</span>, </a>
<a class="sourceLine" id="cb10-4" data-line-number="4">           <span class="st">"general_supply_kwh"</span>, </a>
<a class="sourceLine" id="cb10-5" data-line-number="5">           <span class="dt">plot_type =</span> <span class="st">"quantile"</span>,</a>
<a class="sourceLine" id="cb10-6" data-line-number="6">           <span class="dt">symmetric =</span> <span class="ot">FALSE</span>) </a>
<a class="sourceLine" id="cb10-7" data-line-number="7"><span class="co">#&gt; The first measured variable</span></a>
<a class="sourceLine" id="cb10-8" data-line-number="8"><span class="co">#&gt;             plotted since no response variable specified</span></a>
<a class="sourceLine" id="cb10-9" data-line-number="9"><span class="co">#&gt; Warning in gran_warn(.data, gran1, gran2, hierarchy_tbl = hierarchy_tbl, : Granularities chosen are Clashes.</span></a>
<a class="sourceLine" id="cb10-10" data-line-number="10"><span class="co">#&gt;             </span></a>
<a class="sourceLine" id="cb10-11" data-line-number="11"><span class="co">#&gt; You might be interested to look at the</span></a>
<a class="sourceLine" id="cb10-12" data-line-number="12"><span class="co">#&gt;             set of harmonies using harmony(data).</span></a></code></pre></div>
<p><img src="gravitas_vignette_files/figure-html/example9-1.png" width="768" style="display: block; margin: auto;"></p>
<p>The warning says : Facetting not recommended as there are too many categories in day_quarter and also suggest using day_week as the facet variable.</p>
<p>Moreover, the granularities chosen are clashes and one can see the set of harmonies using <code><a href="../reference/harmony.html">harmony(.data)</a></code></p>
<p>Want to browse through a similar analysis and get insights about the energy behavior of few households? Consider looking at [<a href="https://github.com/Sayani07/gsoc2019/blob/master/smart_meter.pdf" class="uri">https://github.com/Sayani07/gsoc2019/blob/master/smart_meter.pdf</a>].</p>
</div>
<div id="create-any-temporal-granularity-with-create_gran" class="section level3">
<h3 class="hasAnchor">
<a href="#create-any-temporal-granularity-with-create_gran" class="anchor"></a>Create any temporal granularity with <code>create_gran()</code>
</h3>
<p>Any granularity can be built using <code>create_gran</code> if any other plots are to explored which is not included in plot_types of <code>gran_plot</code> or for extracting any other summary statistics. They can be also be used for exploring distribution of the time series across univariate temporal granularity.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1">smart_meter_nsw  <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb11-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="../reference/create_gran.html">create_gran</a></span>(<span class="st">"day_fortnight"</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb11-3" data-line-number="3"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x =</span> <span class="kw"><a href="https://rdrr.io/r/base/factor.html">as.factor</a></span>(day_fortnight),</a>
<a class="sourceLine" id="cb11-4" data-line-number="4">                      <span class="dt">y =</span> general_supply_kwh)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-5" data-line-number="5"><span class="st">  </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span>(<span class="st">"day_fortnight"</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-6" data-line-number="6"><span class="st">  </span><span class="kw"><a href="https://rdrr.io/pkg/lvplot/man/geom_lv.html">geom_lv</a></span>(<span class="dt">outlier.colour =</span> <span class="st">"red"</span>, <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">fill =</span> ..LV..)) <span class="op">+</span><span class="st"> </span><span class="kw">scale_color_brewer</span>(<span class="dt">palette =</span> <span class="st">"Dark2"</span>)</a></code></pre></div>
<p><img src="gravitas_vignette_files/figure-html/example10-1.png" width="768" style="display: block; margin: auto;"></p>
</div>
<div id="how-prob_plot-works" class="section level3">
<h3 class="hasAnchor">
<a href="#how-prob_plot-works" class="anchor"></a>How prob_plot works</h3>
<p>Recommendations for distribution plots depend on the levels of the two granularities plotted. They will vary depending on which granularity is placed on the x-axis and which one across facets. Assumptions are made to ensure display is not too cluttered by the space occupied by various kinds of distribution plots. Moreover, the recommendation system ensures that there are just enough observations before choosing a distribution plot.</p>
<p>Levels are categorized as very high/high/medium/low each for the facet variable and the x-axis variable. Default values for these levels are based on levels of common temporal granularities like day of the month, day of a fortnight or day of a week. For example, any levels above 31 is considered as very high, any levels between 14 to 31 are taken as high and that between 7 to 14 is taken as medium and below 7 is low. 31, 14 and 7 are the levels of days-of-month, days-of-fortnight and days-of week respectively. These default values are decided based on usual cognitive power while comparing across facets and display size available to us.</p>
<p><code>prob_plot</code> choose the recommended plots only if plot_type = NULL. Warnings are generated if users try to plot clashes, number of facet variables are too high or number of observations used to compute statistical summaries for distribution are not large enough.</p>
</div>
</div>
<div id="acknowledgements" class="section level2">
<h2 class="hasAnchor">
<a href="#acknowledgements" class="anchor"></a>Acknowledgements</h2>
<p>Thanks to Prof. Rob J Hyndman, Prof. Dianne Cook and Prof. Antony Unwin for their support and always leading by example. The fine balance of encouraging me to work on my ideas and stepping in to help when I need has made the devlopment of this package a great learning experience for me.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#get-started">Get started</a></li>
      <li><a href="#acknowledgements">Acknowledgements</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Sayani Gupta, Rob Hyndman, Di Cook.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
